import requests
import concurrent.futures

# Define the server URL
url = "https://8ab6-31-222-238-132.ngrok-free.app/api/request"

# Define the payloads
payloads = [
    {
        "query": "В каком городе находится главный кампус Университета ИТМО?\n1. Москва\n2. Санкт-Петербург\n3. Екатеринбург\n4. Нижний Новгород",
        "id": 1
    },
    {
        "query": "В каком году Университет ИТМО был включён в число Национальных исследовательских университетов России?\n1. 2007\n2. 2009\n3. 2011\n4. 2015",
        "id": 2
    },
    {
        "query": "В каком рейтинге (по состоянию на 2021 год) ИТМО впервые вошёл в топ-400 мировых университетов?",
        "id": 3
    }
]

payloads += [
  {
    "query": "В каком году был основан Университет ИТМО?\n1. 1900\n2. 1905\n3. 1910\n4. 1920",
    "id": 12345
  },
  {
    "query": "Как расшифровывается аббревиатура ИТМО?\n1. Институт Технологий и Математического Образования\n2. Информационные Технологии, Механика и Оптика\n3. Институт Технического и Медицинского Образования",
    "id": 67890
  },
  {
    "query": "Какой статус имеет Университет ИТМО?\n1. Национальный исследовательский университет\n2. Федеральный университет\n3. Региональный университет",
    "id": 11223
  },
  {
    "query": "Какой факультет в ИТМО специализируется на программировании?\n1. Факультет Программной Инженерии и Компьютерных Технологий\n2. Факультет Физики\n3. Факультет Биотехнологий",
    "id": 44556
  },
  {
    "query": "Как называется главный кампус ИТМО?\n1. Ломоносовский кампус\n2. Биржевой кампус\n3. Кронверкский кампус",
    "id": 77889
  },
  {
    "query": "Какой международный рейтинг признает ИТМО одним из лучших университетов мира?\n1. QS World University Rankings\n2. Times Higher Education\n3. Shanghai Ranking",
    "id": 99100
  },
  {
    "query": "Какой город является домом для Университета ИТМО?\n1. Москва\n2. Санкт-Петербург\n3. Новосибирск",
    "id": 22334
  },
  {
    "query": "Какой цвет является основным в логотипе ИТМО?\n1. Синий\n2. Красный\n3. Зеленый\n4. Желтый",
    "id": 55667
  },
  {
    "query": "Какой известный конкурс по программированию неоднократно выигрывали студенты ИТМО?\n1. ACM ICPC\n2. Google Code Jam\n3. Facebook Hacker Cup",
    "id": 88990
  },
  {
    "query": "Какой язык программирования чаще всего изучают на начальных курсах в ИТМО?\n1. Python\n2. C++\n3. Java\n4. JavaScript",
    "id": 33445
  },
  {
    "query": "Как называется программа двойных дипломов в ИТМО?\n1. ITMO Double Degree\n2. ITMO Partner Program\n3. ITMO International Degree",
    "id": 66778
  },
  {
    "query": "Какой факультет в ИТМО занимается исследованиями в области фотоники?\n1. Факультет Фотоники и Оптоинформатики\n2. Факультет Информационных Технологий\n3. Факультет Робототехники",
    "id": 99001
  },
  {
    "query": "Какой из этих предметов является обязательным для всех студентов ИТМО?\n1. Математика\n2. Физика\n3. Программирование\n4. Английский язык",
    "id": 11234
  },
  {
    "query": "Как называется студенческий клуб, связанный с киберспортом в ИТМО?\n1. ITMO Cyber Club\n2. ITMO Esports\n3. ITMO Gaming",
    "id": 44567
  },
  {
    "query": "Какой из этих кампусов ИТМО находится на улице Ломоносова?\n1. Кронверкский кампус\n2. Биржевой кампус\n3. Ломоносовский кампус",
    "id": 77890
  },
  {
    "query": "Какой из этих факультетов в ИТМО занимается робототехникой?\n1. Факультет Робототехники и Киберфизических Систем\n2. Факультет Физики\n3. Факультет Программной Инженерии",
    "id": 99111
  },
  {
    "query": "Какой из этих языков чаще всего используется в научных публикациях ИТМО?\n1. Русский\n2. Английский\n3. Немецкий",
    "id": 22345
  },
  {
    "query": "Какой из этих предметов изучается на факультете биотехнологий ИТМО?\n1. Генетика\n2. Программирование\n3. Физика",
    "id": 55678
  },
  {
    "query": "Какой из этих международных партнеров сотрудничает с ИТМО?\n1. MIT (Массачусетский технологический институт)\n2. Оксфордский университет\n3. Токийский университет",
    "id": 88991
  },
  {
    "query": "Какой из этих фестивалей организует ИТМО для студентов?\n1. ITMO.Fest\n2. ITMO.Day\n3. ITMO.Night",
    "id": 33456
  }
]
# Function to send a POST request
def send_post_request(payload):
    try:
        response = requests.post(url, json=payload)
        return response.status_code, response.json()
    except Exception as e:
        return None, str(e)

# Create a list of 20 requests (randomly choosing payloads)
requests_to_send = [payloads[i % len(payloads)] for i in range(100)]

# Use ThreadPoolExecutor to send requests concurrently
with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:
    # Map the send_post_request function to the requests
    futures = [executor.submit(send_post_request, payload) for payload in requests_to_send]

    # Collect and print the results
    i = 0
    for future in concurrent.futures.as_completed(futures):
        status_code, response = future.result()
        print(f"Status Code: {status_code}, Num: {i}")
        i += 1